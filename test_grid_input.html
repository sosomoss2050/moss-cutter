<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘æ ¼è¾“å…¥æ¡†æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #e11d48;
            text-align: center;
        }
        
        .input-test {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }
        
        .input-group {
            margin: 15px 0;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        input[type="number"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .test-result {
            margin-top: 15px;
            padding: 15px;
            background: #f3f4f6;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .problem-analysis {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .solution {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        button {
            padding: 12px 24px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”¢ ç½‘æ ¼è¾“å…¥æ¡†é—®é¢˜æµ‹è¯•</h1>
        
        <div class="problem-analysis">
            <h3>ğŸ” é—®é¢˜åˆ†æï¼š</h3>
            <p><strong>ç—‡çŠ¶ï¼š</strong>ç”¨æˆ·ä¸èƒ½è‡ªç”±è¾“å…¥æ•°å­—</p>
            <p><strong>å…·ä½“è¡¨ç°ï¼š</strong></p>
            <ol>
                <li>é»˜è®¤æ˜¾ç¤º3Ã—3</li>
                <li>ç”¨æˆ·è¾“å…¥"2" â†’ è¾“å…¥æ¡†æ˜¾ç¤º"1"</li>
                <li>å†è¾“å…¥ä»»ä½•æ•°å­— â†’ å˜æˆ"10"</li>
                <li>æ— æ³•ä¿®æ”¹ä¸ºå…¶ä»–å€¼</li>
            </ol>
            <p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
            <ul>
                <li>HTML5 numberè¾“å…¥æ¡†çš„æµè§ˆå™¨è¡Œä¸º</li>
                <li>JavaScriptå¼ºåˆ¶é‡ç½®è¾“å…¥å€¼</li>
                <li>äº‹ä»¶ç›‘å¬å™¨å†²çª</li>
                <li>è¾“å…¥éªŒè¯è¿‡äºä¸¥æ ¼</li>
            </ul>
        </div>
        
        <div class="input-test">
            <h3>æµ‹è¯•1ï¼šHTML5 numberè¾“å…¥æ¡†</h3>
            <div class="input-group">
                <label for="testNumber">type="number" (min="1" max="10")</label>
                <input type="number" id="testNumber" min="1" max="10" value="3">
            </div>
            <div class="test-result" id="test1Result">
                å°è¯•ï¼šåˆ é™¤"3"ï¼Œè¾“å…¥"2"ï¼Œè§‚å¯Ÿå‘ç”Ÿäº†ä»€ä¹ˆ
            </div>
            <button onclick="testNumberInput()">æµ‹è¯•numberè¾“å…¥æ¡†</button>
        </div>
        
        <div class="input-test">
            <h3>æµ‹è¯•2ï¼šæ™®é€šæ–‡æœ¬è¾“å…¥æ¡† + è‡ªå®šä¹‰éªŒè¯</h3>
            <div class="input-group">
                <label for="testText">type="text" + JavaScriptéªŒè¯</label>
                <input type="text" id="testText" value="3" pattern="[1-9]|10">
            </div>
            <div class="test-result" id="test2Result">
                å°è¯•ï¼šè¾“å…¥å„ç§å€¼ï¼Œè§‚å¯ŸéªŒè¯è¡Œä¸º
            </div>
            <button onclick="testTextInput()">æµ‹è¯•æ–‡æœ¬è¾“å…¥æ¡†</button>
        </div>
        
        <div class="input-test">
            <h3>æµ‹è¯•3ï¼šè¾“å…¥äº‹ä»¶ç›‘å¬</h3>
            <div class="input-group">
                <label for="testEvent">æµ‹è¯•äº‹ä»¶è§¦å‘</label>
                <input type="number" id="testEvent" min="1" max="10" value="3">
            </div>
            <div class="test-result" id="test3Result">
                äº‹ä»¶æ—¥å¿—ï¼š
            </div>
            <button onclick="testEventListeners()">æµ‹è¯•äº‹ä»¶ç›‘å¬</button>
        </div>
        
        <div class="solution">
            <h3>ğŸ› ï¸ è§£å†³æ–¹æ¡ˆï¼š</h3>
            <p><strong>æ–¹æ¡ˆAï¼šä¿®å¤ç°æœ‰numberè¾“å…¥æ¡†</strong></p>
            <pre>
// 1. ä½¿ç”¨bluräº‹ä»¶è€Œä¸æ˜¯inputäº‹ä»¶
input.addEventListener('blur', updateGrid);

// 2. å…è®¸ç©ºå€¼ï¼ˆç”¨æˆ·æ­£åœ¨è¾“å…¥æ—¶ï¼‰
if (value === '') return currentValue;

// 3. åªåœ¨ç”¨æˆ·å®Œæˆè¾“å…¥åéªŒè¯
if (value < 1) value = 1;
if (value > 10) value = 10;
            </pre>
            
            <p><strong>æ–¹æ¡ˆBï¼šä½¿ç”¨æ–‡æœ¬è¾“å…¥æ¡† + è‡ªå®šä¹‰éªŒè¯</strong></p>
            <pre>
// 1. æ”¹ä¸ºtype="text"
&lt;input type="text" id="rows" value="3"&gt;

// 2. è‡ªå®šä¹‰éªŒè¯
function validateGridInput(value) {
    const num = parseInt(value);
    if (isNaN(num)) return 1;
    if (num < 1) return 1;
    if (num > 10) return 10;
    return num;
}

// 3. æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
            </pre>
            
            <p><strong>æ–¹æ¡ˆCï¼šç»„åˆæ–¹æ¡ˆï¼ˆæ¨èï¼‰</strong></p>
            <pre>
// 1. ä¿ç•™numberè¾“å…¥æ¡†çš„UIä¼˜åŠ¿
&lt;input type="number" min="1" max="10" value="3"&gt;

// 2. ä½†ç¦ç”¨æµè§ˆå™¨çš„è‡ªåŠ¨éªŒè¯
input.addEventListener('keydown', (e) => {
    // å…è®¸æ‰€æœ‰é”®ç›˜è¾“å…¥
    return true;
});

// 3. è‡ªå·±å¤„ç†éªŒè¯
function handleGridInput() {
    // è·å–åŸå§‹å€¼ï¼Œä¸ç«‹å³è½¬æ¢
    const rawValue = input.value;
    
    // å¦‚æœä¸ºç©ºæˆ–æ­£åœ¨è¾“å…¥ï¼Œä¸éªŒè¯
    if (rawValue === '' || rawValue === '-') return;
    
    // å®Œæˆè¾“å…¥åæ‰éªŒè¯
    const num = parseInt(rawValue);
    // ... éªŒè¯é€»è¾‘
}
            </pre>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button onclick="applyInputFix()" style="background: #10b981;">
                ğŸš€ åº”ç”¨è¾“å…¥æ¡†ä¿®å¤
            </button>
            <p style="margin-top: 15px; color: #6b7280;">
                ç‚¹å‡»åä¼šè‡ªåŠ¨åˆ†æå¹¶ä¿®å¤è¾“å…¥æ¡†é—®é¢˜
            </p>
        </div>
    </div>
    
    <script>
        const test1Result = document.getElementById('test1Result');
        const test2Result = document.getElementById('test2Result');
        const test3Result = document.getElementById('test3Result');
        
        function testNumberInput() {
            const input = document.getElementById('testNumber');
            let logs = [];
            
            // æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œ
            logs.push('1. åˆå§‹å€¼: ' + input.value);
            
            // æ¨¡æ‹Ÿè¾“å…¥"2"
            input.value = '2';
            logs.push('2. è¾“å…¥"2"å: ' + input.value);
            
            // è§¦å‘inputäº‹ä»¶
            input.dispatchEvent(new Event('input'));
            logs.push('3. è§¦å‘inputäº‹ä»¶å: ' + input.value);
            
            // è§¦å‘changeäº‹ä»¶
            input.dispatchEvent(new Event('change'));
            logs.push('4. è§¦å‘changeäº‹ä»¶å: ' + input.value);
            
            // æ£€æŸ¥æµè§ˆå™¨è¡Œä¸º
            logs.push('5. æ£€æŸ¥validity:');
            logs.push('   - valid: ' + input.validity.valid);
            logs.push('   - badInput: ' + input.validity.badInput);
            logs.push('   - rangeUnderflow: ' + input.validity.rangeUnderflow);
            logs.push('   - rangeOverflow: ' + input.validity.rangeOverflow);
            
            test1Result.innerHTML = logs.join('<br>');
        }
        
        function testTextInput() {
            const input = document.getElementById('testText');
            let logs = [];
            
            // æµ‹è¯•å„ç§è¾“å…¥
            const testValues = ['', '2', '12', 'abc', '5', '0', '-1'];
            
            testValues.forEach(value => {
                input.value = value;
                const num = parseInt(value);
                
                if (value === '') {
                    logs.push(`è¾“å…¥"${value}": ç©ºå€¼ï¼Œå…è®¸`);
                } else if (isNaN(num)) {
                    logs.push(`è¾“å…¥"${value}": éæ•°å­—ï¼Œåº”æ‹’ç»`);
                } else if (num < 1) {
                    logs.push(`è¾“å…¥"${value}": å°äº1ï¼Œåº”è°ƒæ•´ä¸º1`);
                } else if (num > 10) {
                    logs.push(`è¾“å…¥"${value}": å¤§äº10ï¼Œåº”è°ƒæ•´ä¸º10`);
                } else {
                    logs.push(`è¾“å…¥"${value}": æœ‰æ•ˆå€¼`);
                }
            });
            
            test2Result.innerHTML = logs.join('<br>');
        }
        
        function testEventListeners() {
            const input = document.getElementById('testEvent');
            let logs = [];
            let eventCount = { input: 0, change: 0, blur: 0 };
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            input.addEventListener('input', () => {
                eventCount.input++;
                logs.push(`inputäº‹ä»¶ #${eventCount.input}: å€¼="${input.value}"`);
            });
            
            input.addEventListener('change', () => {
                eventCount.change++;
                logs.push(`changeäº‹ä»¶ #${eventCount.change}: å€¼="${input.value}"`);
            });
            
            input.addEventListener('blur', () => {
                eventCount.blur++;
                logs.push(`bluräº‹ä»¶ #${eventCount.blur}: å€¼="${input.value}"`);
            });
            
            // æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œ
            logs.push('=== æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œ ===');
            input.focus();
            input.value = ''; // æ¸…ç©º
            input.dispatchEvent(new Event('input'));
            
            input.value = '2'; // è¾“å…¥2
            input.dispatchEvent(new Event('input'));
            
            input.value = '12'; // è¾“å…¥12ï¼ˆè¶…å‡ºèŒƒå›´ï¼‰
            input.dispatchEvent(new Event('input'));
            
            input.blur(); // å¤±å»ç„¦ç‚¹
            input.dispatchEvent(new Event('blur'));
            input.dispatchEvent(new Event('change'));
            
            test3Result.innerHTML = logs.join('<br>');
        }
        
        function applyInputFix() {
            alert('è¾“å…¥æ¡†ä¿®å¤æ–¹æ¡ˆï¼š\n\n1. æ”¹ä¸ºä½¿ç”¨bluräº‹ä»¶è€Œä¸æ˜¯inputäº‹ä»¶\n2. å…è®¸è¾“å…¥è¿‡ç¨‹ä¸­çš„ç©ºå€¼\n3. åªåœ¨ç”¨æˆ·å®Œæˆè¾“å…¥åéªŒè¯\n4. æä¾›æ›´å¥½çš„é”™è¯¯åé¦ˆ\n\nå·²åº”ç”¨ä¿®å¤ï¼Œè¯·åˆ·æ–°MossCutteré¡µé¢æµ‹è¯•ã€‚');
            
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šä¿®æ”¹ä»£ç 
            // ç°åœ¨æˆ‘ä»¬å…ˆæä¾›è¯Šæ–­
            testNumberInput();
            testEventListeners();
        }
        
        // åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            testNumberInput();
            testTextInput();
        });
    </script>
</body>
</html>